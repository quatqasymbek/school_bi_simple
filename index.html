<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>–®–∫–æ–ª—å–Ω–∞—è –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (BI)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        :root { --primary: #123b71; --bg: #f4f7f6; --card-bg: #ffffff; --text: #333; --border: #dde2e5; }
        * { box-sizing: border-box; }
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); display: flex; flex-direction: column; height: 100vh; }
        header { background: var(--primary); color: #fff; padding: 0 20px; height: 60px; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
        header h1 { font-size: 1.2rem; margin: 0; font-weight: 600; }
        .tabs-bar { background: #1c4e8f; display: flex; overflow-x: auto; flex-shrink: 0; }
        .tab-link { padding: 12px 20px; color: #b0c4de; text-decoration: none; font-size: 0.9rem; border-bottom: 3px solid transparent; cursor: pointer; white-space: nowrap; }
        .tab-link.active { color: #fff; border-bottom-color: #fff; font-weight: 500; }
        main { flex: 1; overflow-y: auto; padding: 20px; }
        .page { display: none; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .grid-1 { display: grid; grid-template-columns: 1fr; gap: 20px; }
        .card { background: var(--card-bg); border-radius: 8px; padding: 20px; border: 1px solid var(--border); margin-bottom: 20px; }
        .card h3 { margin-top: 0; font-size: 1rem; color: #555; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px;}
        .controls-row { display: flex; gap: 15px; margin-bottom: 15px; align-items: center; flex-wrap: wrap; background: #fff; padding: 15px; border-radius: 8px; border: 1px solid var(--border); }
        select, button { padding: 8px 12px; border: 1px solid #ccc; border-radius: 4px; }
        button { background: var(--primary); color: white; border: none; cursor: pointer; }
        button:hover { background: #0e2a50; }
        .table-responsive { overflow-x: auto; }
        table.data-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; white-space: nowrap; }
        table.data-table th, table.data-table td { padding: 10px 15px; text-align: center; border-bottom: 1px solid #eee; }
        table.data-table th { background: #f9f9f9; font-weight: 600; color: #555; text-align: left; }
        table.data-table td:first-child { text-align: left; font-weight: 500; }
        .grade-bad { color: #e74c3c; font-weight: bold; }
        .grade-good { color: #2ecc71; font-weight: bold; }
        #statusBar { font-size: 12px; color: #ffeb7f; cursor: pointer; }
    </style>
</head>

<body>

<header>
    <div style="display:flex; align-items:center; gap:10px;">
        <span>üìä</span>
        <h1>–®–∫–æ–ª—å–Ω–∞—è –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h1>
    </div>
    <div>
        <span id="statusBar">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å Excel</span>
    </div>
</header>

<div class="tabs-bar">
    <div class="tab-link active" data-page="overview">–û–±–∑–æ—Ä</div>
    <div class="tab-link" data-page="classes">–ö–ª–∞—Å—Å—ã</div>
    <div class="tab-link" data-page="subjects">–ü—Ä–µ–¥–º–µ—Ç—ã</div>
    <div class="tab-link" data-page="teachers">–£—á–∏—Ç–µ–ª—è</div>
    <div class="tab-link" data-page="attendance">–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</div>
    <div class="tab-link" data-page="students">–£—á–µ–Ω–∏–∫–∏</div>
</div>

<main>

<!-- ====================================================== -->
<!-- ===================== –û–ë–ó–û–† PAGE ===================== -->
<!-- ====================================================== -->

<div id="overview" class="page active">
    <div class="card">
        <h3>–û–±—â–∏–π –æ–±–∑–æ—Ä</h3>

        <div class="controls-row">
            <label>–ß–µ—Ç–≤–µ—Ä—Ç—å:</label>
            <select id="ovTermSelect"></select>

            <label>–ú–µ—Ç—Ä–∏–∫–∞:</label>
            <select id="ovMetricSelect">
                <option value="quality">–ö–∞—á–µ—Å—Ç–≤–æ –∑–Ω–∞–Ω–∏–π (%)</option>
                <option value="avg">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</option>
            </select>

            <button id="btn-overview-refresh">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>

        <div class="grid-2">
            <div class="card">
                <h3>–í—Å–µ–≥–æ —É—á–∞—â–∏—Ö—Å—è</h3>
                <div id="kpi-students" class="kpi-value">-</div>
            </div>

            <div class="card">
                <h3>–í—Å–µ–≥–æ —É—á–∏—Ç–µ–ª–µ–π</h3>
                <div id="kpi-teachers" class="kpi-value">-</div>
            </div>
        </div>

        <div id="chart-overview-donut" style="height:350px;"></div>
        <div id="chart-overview-grades" style="height:350px;"></div>
    </div>
</div>


<!-- ====================================================== -->
<!-- ===================== –ö–õ–ê–°–°–´ PAGE ==================== -->
<!-- ====================================================== -->

<div id="classes" class="page">
    <div class="card">
        <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∫–ª–∞—Å—Å–∞–º</h3>

        <div class="controls-row">
            <label>–ß–µ—Ç–≤–µ—Ä—Ç—å:</label>
            <select id="clsTableTermSelect"></select>

            <label>–ú–µ—Ç—Ä–∏–∫–∞:</label>
            <select id="clsTableMetricSelect">
                <option value="quality">–ö–∞—á–µ—Å—Ç–≤–æ –∑–Ω–∞–Ω–∏–π (%)</option>
                <option value="average">–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª (5-–±–∞–ª.)</option>
            </select>
        </div>

        <div class="table-responsive">
            <table class="data-table">
                <thead>
                    <tr id="class-summary-header"></tr>
                </thead>
                <tbody id="class-summary-body"></tbody>
            </table>
        </div>
    </div>

    <div class="card">
        <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤</h3>

        <div class="controls-row">
            <label>–ö–ª–∞—Å—Å:</label>
            <select id="clsDonutClassSelect"></select>

            <label>–ß–µ—Ç–≤–µ—Ä—Ç—å:</label>
            <select id="clsDonutTermSelect"></select>
        </div>

        <div id="chart-class-donut" style="height:350px;"></div>
    </div>
</div>


<!-- ====================================================== -->
<!-- =================== –ü–†–ï–î–ú–ï–¢–´ PAGE ==================== -->
<!-- ====================================================== -->

<div id="subjects" class="page">
    <div class="card">
        <h3>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–µ–¥–º–µ—Ç–æ–≤</h3>
        <p>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á—ë–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ Excel.</p>
    </div>
</div>


<!-- ====================================================== -->
<!-- ===================== –£–ß–ò–¢–ï–õ–Ø PAGE =================== -->
<!-- ====================================================== -->

<div id="teachers" class="page">
    <div class="card">
        <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —É—á–∏—Ç–µ–ª–µ–π</h3>
        <p>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ Excel.</p>
    </div>
</div>


<!-- ====================================================== -->
<!-- ================== –ü–û–°–ï–©–ê–ï–ú–û–°–¢–¨ PAGE ================= -->
<!-- ====================================================== -->

<div id="attendance" class="page">
    <div class="card">
        <h3>–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</h3>
        <div id="attendance-chart"></div>
    </div>
</div>


<!-- ====================================================== -->
<!-- ===================== –£–ß–ï–ù–ò–ö–ò PAGE =================== -->
<!-- ====================================================== -->

<div id="students" class="page">
    <div class="card">
        <h3>–°–ø–∏—Å–æ–∫ —É—á–∞—â–∏—Ö—Å—è</h3>

        <div class="controls-row">
            <label>–ö–ª–∞—Å—Å:</label>
            <select id="stClassSelect"></select>

            <label>–ß–µ—Ç–≤–µ—Ä—Ç—å:</label>
            <select id="stTermSelect"></select>

            <button id="stRefreshBtn">–û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>

        <div id="stTableWrapper" class="table-responsive"></div>
    </div>
</div>

</main>

<!-- JS LIBRARIES -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>

<!-- YOUR JS -->
<script src="utils.js"></script>
<script src="main.js"></script>
<script src="llm_cpu.js"></script>
<script src="overview.js"></script>
<script src="overview_ai.js"></script>
<script src="attendance.js"></script>
<script src="dashboard_class.js"></script>
<script src="dashboard_subject.js"></script>
<script src="dashboard_teacher.js"></script>
<script src="dashboard_student.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const links = document.querySelectorAll('.tab-link');
    const pages = document.querySelectorAll('.page');

    function activate(page) {
        pages.forEach(p => p.classList.remove("active"));
        document.getElementById(page).classList.add("active");

        links.forEach(l => l.classList.remove("active"));
        document.querySelector(`.tab-link[data-page="${page}"]`).classList.add("active");
    }

    links.forEach(l => {
        l.addEventListener("click", () => activate(l.dataset.page));
    });
});
</script>

</body>
</html>
